class t{constructor(){this.currentSlide=0,this.slides=["scenario1.html","scenario2.html","scenario3.html","scenario4.html","scenario5.html","scenario6.html","summary.html"],this.container=document.querySelector(".slide-container"),this.dotsContainer=document.querySelector(".slide-dots"),this.isAnimating=!1,this.touchStartX=0,this.touchEndX=0}async init(){window.addEventListener("popstate",(t=>{const e=window.location.pathname.replace("/",""),i=this.slides.indexOf(e);-1!==i&&this.loadSlide(i,!0)})),await this.loadSlide(this.currentSlide),this.setupEventListeners(),this.createDots(),this.setupAutoplay(),this.updateDots()}async loadSlide(t,e=!1){if(!this.isAnimating){this.isAnimating=!0,this.container.innerHTML='<div style="display:flex;justify-content:center;align-items:center;height:100%;font-size:1.5rem;color:#9ca3af;">로딩 중...</div>';try{const i=await fetch("/"+this.slides[t]);if(!i.ok)throw new Error("슬라이드 파일을 불러올 수 없습니다.");const s=await i.text(),n=new DOMParser,o=n.parseFromString(s,"text/html").querySelector(".slide-content");o?(this.container.style.opacity="0",await new Promise((t=>setTimeout(t,300))),this.container.innerHTML=o.innerHTML,this.container.style.opacity="1",this.currentSlide=t,this.updateDots(),this.container.scrollTop=0,setTimeout((()=>{this.container.scrollTop=0;const t=this.container.querySelector(".scrollable");t&&(t.scrollTop=0)}),50),e||window.history.pushState({slide:t},"",this.slides[t])):this.container.innerHTML='<div style="color:#f87171;text-align:center;padding:2rem;">슬라이드 컨텐츠를 찾을 수 없습니다.</div>'}catch(i){this.container.innerHTML=`<div style="color:#f87171;text-align:center;padding:2rem;">슬라이드 로딩 오류: ${i.message}</div>`}finally{this.isAnimating=!1}}}setupEventListeners(){var t,e;null==(t=document.querySelector(".prev-slide"))||t.addEventListener("click",(()=>this.prevSlide())),null==(e=document.querySelector(".next-slide"))||e.addEventListener("click",(()=>this.nextSlide())),document.addEventListener("keydown",(t=>{"ArrowLeft"===t.key&&this.prevSlide(),"ArrowRight"===t.key&&this.nextSlide()})),this.container.addEventListener("touchstart",(t=>{this.touchStartX=t.touches[0].clientX})),this.container.addEventListener("touchend",(t=>{this.touchEndX=t.changedTouches[0].clientX,this.handleSwipe()}))}handleSwipe(){const t=this.touchStartX-this.touchEndX;Math.abs(t)>50&&(t>0?this.nextSlide():this.prevSlide())}createDots(){this.slides.forEach(((t,e)=>{const i=document.createElement("button");i.className="slide-dot",i.setAttribute("aria-label",`슬라이드 ${e+1}로 이동`),i.addEventListener("click",(()=>this.loadSlide(e))),this.dotsContainer.appendChild(i)}))}updateDots(){this.dotsContainer.querySelectorAll(".slide-dot").forEach(((t,e)=>{t.classList.toggle("active",e===this.currentSlide)}))}prevSlide(){const t=(this.currentSlide-1+this.slides.length)%this.slides.length;this.loadSlide(t)}nextSlide(){const t=(this.currentSlide+1)%this.slides.length;this.loadSlide(t)}setupAutoplay(){setInterval((()=>{document.hidden||this.isAnimating||this.nextSlide()}),1e4)}}document.addEventListener("DOMContentLoaded",(()=>{(new t).init()}));
